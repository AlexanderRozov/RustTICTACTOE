@echo off
echo ========================================
echo –ü–û–õ–ù–ê–Ø –†–ï–õ–ò–ó–ù–ê–Ø –°–ë–û–†–ö–ê –ü–†–û–ï–ö–¢–ê
echo ========================================
echo.

echo üßπ –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–±–æ—Ä–æ–∫...
cargo clean

echo.
echo üñ•Ô∏è  –°–±–æ—Ä–∫–∞ —Ä–µ–ª–∏–∑–Ω–æ–π –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–π –≤–µ—Ä—Å–∏–∏...
cargo build --release

if %ERRORLEVEL% EQU 0 (
    echo ‚úÖ –î–µ—Å–∫—Ç–æ–ø–Ω–∞—è —Å–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞!
) else (
    echo ‚ùå –û—à–∏–±–∫–∞ –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–π —Å–±–æ—Ä–∫–∏!
    goto :error
)

echo.
echo üåê –°–±–æ—Ä–∫–∞ —Ä–µ–ª–∏–∑–Ω–æ–π –≤–µ–±-–≤–µ—Ä—Å–∏–∏ (WASM)...
cargo build --release --target wasm32-unknown-unknown

if %ERRORLEVEL% EQU 0 (
    echo ‚úÖ WASM —Å–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞!
    
    echo.
    echo üì¶ –£–ø–∞–∫–æ–≤–∫–∞ –¥–ª—è –≤–µ–±-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è...
    wasm-pack build --target web --release
    
    if %ERRORLEVEL% EQU 0 (
        echo ‚úÖ –í–µ–±-–ø–∞–∫–µ—Ç —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!
    ) else (
        echo ‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–±-–ø–∞–∫–µ—Ç–∞!
        goto :error
    )
) else (
    echo ‚ùå –û—à–∏–±–∫–∞ WASM —Å–±–æ—Ä–∫–∏!
    goto :error
)

echo.
echo üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤...
cargo test --release

if %ERRORLEVEL% EQU 0 (
    echo ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ!
) else (
    echo ‚ö†Ô∏è  –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—à–ª–∏, –Ω–æ —Å–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
)

echo.
echo ========================================
echo üéâ –†–ï–õ–ò–ó–ù–ê–Ø –°–ë–û–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–ï–®–ù–û!
echo ========================================
echo.
echo üìÅ –§–∞–π–ª—ã –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é:
echo    üñ•Ô∏è  –î–µ—Å–∫—Ç–æ–ø: target\release\rust_tic_tac_toe.exe
echo    üåê –í–µ–±: pkg\ (–æ—Ç–∫—Ä–æ–π—Ç–µ checkers.html)
echo.
echo üöÄ –ó–∞–ø—É—Å–∫ –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–π –≤–µ—Ä—Å–∏–∏...
target\release\rust_tic_tac_toe.exe --checkers

goto :end

:error
echo.
echo ========================================
echo ‚ùå –°–ë–û–†–ö–ê –ó–ê–í–ï–†–®–ò–õ–ê–°–¨ –° –û–®–ò–ë–ö–ê–ú–ò
echo ========================================
echo –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.

:end
echo.
pause
